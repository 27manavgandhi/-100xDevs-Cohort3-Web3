# 4.1 - Solana Jargon, Programming Model & Tokens

> **Course**: 100xDevs Cohort 3.0 — Web3 Track
> **Instructor**: Harkirat Singh
> **Week**: 4.1
> **Slides**: https://petal-estimate-4e9.notion.site/Solana-Jargon-Programming-model-Tokens-45937002d4c24cda9d02fc02a6dedc1c

---

## Topics Covered Today

1. Context — What ETH and SOL solve over Bitcoin
2. Why Solana? — Programs / Smart Contracts
3. Accounts on Solana — Data, Lamports, Programs
4. Install Solana CLI
5. Web2 Data Model vs Solana Data Model
6. Creating a Token (Token Mint + ATA)
7. Equivalent code in JS
8. Equivalent code in Rust/Python/Go
9. PDAs — Program Derived Addresses
10. Token-22 Program
11. Token-22 with Metadata

---

## 1. Context

**What we know so far:**
- Hashing (SHA-256), Public/Private Keys, HD Wallets
- How blockchains work under the hood
- How miners use signatures to verify and credit/debit balances

**Today:** The biggest use-case blockchains like Solana/ETH solve — **Programs / Smart Contracts**

---

## 2. Why Solana? — Programs / Smart Contracts

### ETH introduced Smart Contracts

ETH was one of the first blockchains to introduce the concept of **decentralized state / programs**, popularly known as **smart contracts**.

**Simple ETH Smart Contract (Solidity):**
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Counter {
    uint public count;

    constructor() { count = 0; }

    function increment() public { count += 1; }

    function decrement() public {
        require(count > 0, "Count cannot be negative");
        count -= 1;
    }

    function getCount() public view returns (uint) { return count; }
}
```

**Equivalent Node.js HTTP server (Web2):**
```js
const express = require('express');
const app = express();
const port = 3000;

app.use(express.json());
let count = 0;

app.post('/increment', (req, res) => { count += 1; res.json({ count }); });
app.post('/decrement', (req, res) => {
  if (count > 0) { count -= 1; res.json({ count }); }
  else { res.status(400).json({ error: 'Count cannot be negative' }); }
});
app.get('/count', (req, res) => { res.json({ count }); });

app.listen(port, () => console.log(`Server running at http://localhost:${port}`));
```

> HTTP Servers are deployed on cloud providers like GCP, Azure.
> Smart contracts/programs are deployed on the **blockchain**.

The way Solana programs work is **significantly different** from other blockchains.

### Traditional Process vs Smart Contracts (House Buying Example)

**Traditional:**
1. Buyer + Seller agree on terms
2. Middlemen: real estate agent, lawyer, bank
3. Payment & ownership transfer through legal docs
4. Trust placed in intermediaries — slow, costly, complex

**With Smart Contracts:**
1. Smart contract created with all terms coded in
2. Buyer deposits funds; seller confirms house details
3. Contract auto-verifies conditions (inspection, title)
4. Automatically transfers funds to seller + ownership to buyer
5. No intermediaries needed — transparent, immutable, secure

**Key Features:**
- **Automation** — executes when conditions are met
- **Trust** — code enforces terms, no intermediaries needed
- **Transparency** — all actions recorded on blockchain
- **Security** — cannot be altered once deployed

---

## 3. Accounts on Solana

On the Solana blockchain, an **"account"** is a fundamental data structure used to store various types of information.

### Three Types of Accounts

| Account Type | Purpose | Analogy |
|---|---|---|
| **Wallet Account** | Stores lamport/token balances | Piggy Bank Box |
| **Program Account** | Contains executable code (smart contracts) | Toy Instructions Box |
| **Data Account** | Stores data required by programs | Game Pieces Box |

### Key Properties

1. **Data Storage** — Accounts store data required by programs (smart contracts) or to maintain state
2. **Lamports** — Accounts hold a balance of Solana's native currency (lamports), used to pay tx fees and rent for blockchain space
3. **Programs** — Special accounts containing executable code, designed to be executed when triggered by a transaction

### Account Examples on Solscan

- **Account with data and lamports but no executable flag**:
  https://explorer.solana.com/address/4GQsaPSjYi5ysGF1GEnWiV3ziHZLRcLWhLCSuim6aAkL

- **Account with lamports but no data**:
  https://solscan.io/account/Eg4F6LW8DD3SvFLLigYJBFvRnXSBiLZYYJ3KEePDL95Q

- **Program Account**:
  https://solscan.io/account/TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA

---

## 4. Install Solana CLI

**Mac/Linux:**
```bash
sh -c "$(curl -sSfL https://release.anza.xyz/stable/install)"
```

**Windows:**
Download from: https://github.com/solana-labs/solana/releases
- Download `solana-release-x86_64-pc-windows-msvc.tar.bz2`
- Unzip → you'll see all `.exe` files including `solana.exe`, `spl-token.exe`

**Useful CLI Commands:**
```bash
solana config set --url https://api.devnet.solana.com   # Set to devnet
solana-keygen new                                        # Create new wallet
solana airdrop 2                                         # Get 2 SOL on devnet
solana balance                                           # Check balance
```

---

## 5. Web2 Data Model vs Solana Data Model

### Web2 Data Model

In Web2, data is stored in SQL/NoSQL databases. For a token balance app:

```
USDC Balance Table          $DADDY Balance Table
┌─────────┬─────────┐      ┌─────────┬───────────────┐
│ user_id │ balance │      │ user_id │    balance    │
├─────────┼─────────┤      ├─────────┼───────────────┤
│    1    │   100   │      │    1    │  100,000,000  │
│    2    │   300   │      │    2    │    3,012,300  │
│    3    │   150   │      │    3    │      100,150  │
│    4    │    90   │      │    4    │  900,000,000  │
└─────────┴─────────┘      └─────────┴───────────────┘
```

Operations: subtract from sender's row, add to receiver's row. All in a central database.

### Solana Data Model

Solana stores all data of the same app/program in **various accounts**.

```
                    ┌──────────────┐
   ATA              │              │  ATA
  (user 3)   ──────▶  USDC Mint  ◀──────  (user 1)
  150 USDC          │              │        100 USDC
                    └──────────────┘
                           │
                    ┌──────────────┐
   ATA              │   Solana     │  ATA
  (user 4)   ──────▶  Token Prog  ◀──────  (user 2)
  90 USDC           │              │        300 USDC
                    └──────────────┘
```

Each user has an **Associated Token Account (ATA)** — a separate account per token per user. No central table. Balances live on-chain in accounts.

### Transaction vs Instruction

- **Transaction**: A bundle that includes one or more instructions. Used to submit operations or changes to the network.
- **Instruction**: The core operation that the transaction will execute.

> Other concepts: `recentBlockhash`, `signers`, `writeable` — covered later.

### How to Create an Account with Data (JS)

```js
const solanaWeb3 = require('@solana/web3.js');
const fs = require("fs");
const { Keypair, Connection, SystemProgram, Transaction, sendAndConfirmTransaction } = solanaWeb3;

const connection = new Connection(solanaWeb3.clusterApiUrl('devnet'), 'confirmed');
const dataAccount = Keypair.generate();
const payer = Keypair.fromSecretKey(new Uint8Array(JSON.parse(fs.readFileSync("/Users/har/.config/solana/id.json"))));

async function createAccount() {
  const tx = new Transaction().add(
    SystemProgram.createAccount({
      fromPubkey: payer.publicKey,
      newAccountPubkey: dataAccount.publicKey,
      lamports: await connection.getMinimumBalanceForRentExemption(1000),
      space: 1000,
      programId: SystemProgram.programId,
    })
  );
  const txId = await sendAndConfirmTransaction(connection, tx, [payer, dataAccount]);
  console.log(`Created account with transaction ID: ${txId}`);
}

createAccount();
```

---

## 6. Creating a Token

Creating your own token (e.g. 100xCoin) requires understanding the **Token Program** written by Solana engineers:
https://github.com/solana-labs/solana-program-library

### Steps to Create a Token

1. **Create a Token Mint** — The mint is like a bank that has authority to create more coins
2. **Create an Associated Token Account (ATA)** — One per user per token
3. **Mint tokens** to that user

### Token Mint

A **Token Mint** is the authority that can create (mint) new tokens. It can also have:
- `mint_authority` — who can mint new tokens
- `freeze_authority` — who can freeze token accounts

### Associated Token Account (ATA)

When you want to send/receive tokens, you need an ATA — a dedicated account for a specific token + specific user combination.

### CLI Commands to Create a Token

```bash
# Install spl-token CLI
npm install -g @solana/spl-token

# Set RPC to devnet
solana config set --url https://api.devnet.solana.com

# Add SOL to yourself
solana airdrop 2

# Create token mint
spl-token create-token

# Create associated token account (ATA)
spl-token create-account <TOKEN_MINT_ADDRESS>

# Mint tokens to the ATA
spl-token mint <TOKEN_MINT_ADDRESS> 100

# Check token balance
spl-token balance <TOKEN_MINT_ADDRESS>

# Check supply of the token
spl-token supply <TOKEN_MINT_ADDRESS>

# Create associated token account (mint tokens to yourself)
spl-token create-account <TOKEN_MINT_ADDRESS>

# Send some tokens to yourself
spl-token transfer --fund-recipient <TOKEN_MINT> <AMOUNT> <RECIPIENT_ADDRESS>
```

---

## 7. Equivalent Code in JS

```bash
npm install @solana/spl-token
npm install @solana/web3.js
```

```js
import { LAMPORTS_PER_SOL, clusterApiUrl } from "@solana/web3.js";
import { createMint, getOrCreateAssociatedTokenAccount, mintTo, transfer } from '@solana/spl-token';

// Write a function called airdropIfRequired
async function airdropIfRequired(connection, publicKey, amount) {
  const balance = await connection.getBalance(publicKey);
  if (balance < amount) {
    await connection.requestAirdrop(publicKey, amount - balance);
  }
  console.log('Airdrop done:', publicKey.toString());
}

// Check your balance
solana balance

// Create a mint
const mint = await createMint(
  conn,
  payer,            // payer
  payer.publicKey,  // mint authority
  payer.publicKey,  // freeze authority
  6                 // decimals
);
console.log("Mint created:", mint.toBase58());
```

**Full JS flow — create mint, ATA, mint tokens:**

```js
import { Connection, Keypair, LAMPORTS_PER_SOL, clusterApiUrl } from "@solana/web3.js";
import { createMint, getOrCreateAssociatedTokenAccount, mintTo, transfer } from '@solana/spl-token';

const connection = new Connection(clusterApiUrl('devnet'), 'confirmed');
const payer = Keypair.generate();

async function main() {
  // Airdrop SOL for fees
  await connection.requestAirdrop(payer.publicKey, LAMPORTS_PER_SOL);

  // Create mint
  const mint = await createMint(connection, payer, payer.publicKey, payer.publicKey, 6);
  console.log("Mint:", mint.toBase58());

  // Create ATA for payer
  const payerATA = await getOrCreateAssociatedTokenAccount(connection, payer, mint, payer.publicKey);
  console.log("ATA:", payerATA.address.toBase58());

  // Mint 100 tokens to payer ATA
  await mintTo(connection, payer, mint, payerATA.address, payer, 100 * (10 ** 6));
  console.log("Minted 100 tokens");

  // Transfer to another wallet
  const dest = Keypair.generate();
  const destATA = await getOrCreateAssociatedTokenAccount(connection, payer, mint, dest.publicKey);
  await transfer(connection, payer, payerATA.address, destATA.address, payer, 10 * (10 ** 6));
  console.log("Transferred 10 tokens");
}

main();
```

---

## 8. Equivalent Code in Rust/Python/Go

Solana has libraries similar to `@solana/web3.js` in Rust, Python, Go. In the end, **they all send requests to an RPC server**.

```
Rust ─┐
      ├──▶  RPC  ──▶  Blockchain
JS   ─┤
      │
CLI  ─┘
```

---

## 9. PDAs — Program Derived Addresses

When you created an **associated token account**, you actually created a **PDA**.

A PDA is an account address that is derived deterministically from:
- A program ID
- A set of seeds (e.g. user public key + mint address)

This means the same inputs always produce the same PDA — no private key exists for it. Only the program can sign for it.

**Reference (Rust):**
https://github.com/solana-labs/solana-program-library/blob/master/associated-token-account/program/src/lib.rs#L71

**Reference (JS):**
https://github.com/solana-labs/solana-program-library/blob/ab830053c59c9c35bc3a727703aacf40c1215132/token/js/src/state/mint.ts#L171

---

## 10. Token-22 Program

**Ref**: https://spl.solana.com/token-2022

The **Token-2022 Program** (also known as Token Extensions) is a superset of the original Token Program. It supports fungible and non-fungible tokens with additional extensions like metadata, transfer fees, and more.

### CLI Commands for Token-22

```bash
# Create token mint with Token-22 program
spl-token create-token --program-id TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb

# Create associated token account
spl-token create-account 8FTM5XYRaoTJU9PLUuyakFJEypQ4RXL5HtxKtiw2z9pQQ

# Mint the tokens
spl-token mint 8FTM5XYRaoTJU9PLUuyakFJEypQ4RXL5HtxKtiw2z9pQQ 100
```

---

## 11. Token-22 with Metadata

Metadata JSON reference: https://cdn.100xdevs.com/metadata.json

```bash
# Create token with metadata enabled
spl-token --program-id TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb create-token --enable-metadata

# Initialize metadata
spl-token initialize-metadata pXfZ6Hg2s78m1iSRVsdzos9TmfkqkQdv5MnQrr77ZQK 100xx 100xx: <URI>

# Create ATA
spl-token create-account pXfZ6Hg2s78m1iSRVsdzos9TmfkqkQdv5MnQrr77ZQK

# Mint tokens
spl-token mint 1000
```

After minting, the token shows up in Phantom wallet with your custom name, symbol, and image (from metadata URI).

---

## Assignment

1. **Show all tokens** that the user has in our web-based wallet (from Day 3)
2. **Create a token launchpad website** that lets users launch tokens, taking inputs like:
   - Token name & symbol
   - Decimals
   - Freeze authority
   - Initial supply

---

## Key Concepts Summary

| Concept | Description |
|---------|-------------|
| Smart Contract | Decentralized program deployed on blockchain, auto-executes when conditions met |
| Solana Program | Equivalent of ETH smart contract on Solana, written in Rust |
| Account | Fundamental data structure on Solana — stores data, lamports, or code |
| Wallet Account | Holds lamport/token balances |
| Program Account | Contains executable code |
| Data Account | Stores program state/data |
| Token Mint | The authority that creates tokens (like a central bank) |
| ATA | Associated Token Account — one per user per token |
| PDA | Program Derived Address — deterministic, no private key |
| Token-22 | Extended token program with metadata, transfer fees, etc. |
| Lamport | Smallest SOL unit (10^-9 SOL) |
| Transaction | Bundle of one or more instructions submitted to the network |
| Instruction | A single operation within a transaction |

---

## References

- Slides: https://petal-estimate-4e9.notion.site/Solana-Jargon-Programming-model-Tokens-45937002d4c24cda9d02fc02a6dedc1c
- Week 4.1 Notes: https://feather-lion-ff2.notion.site/Week-4-1-ea74dde0b0b24d92a2b373f52aa70bbe
- Token Program: https://github.com/solana-labs/solana-program-library
- Token-22: https://spl.solana.com/token-2022
- Solana CLI releases: https://github.com/solana-labs/solana/releases
- SPL Token JS: https://www.npmjs.com/package/@solana/spl-token
