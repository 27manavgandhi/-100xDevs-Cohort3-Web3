# 9.1 - DEX, CEX, Orderbooks, AMM & DeFi Jargon — Assignment

> **Class Slides**: https://petal-estimate-4e9.notion.site/Decentralized-exchanges-1147dfd1073580dd8956cd90985c3fd7
> **Notes**: https://feather-lion-ff2.notion.site/Week-9-1-116246afc9f2801ea8adc07e1c1a2a22

---

## Core Assignment

### Task 1 — Conceptual Questions

Answer in your own words (no copy-paste):

1. What is the difference between a DEX and a CEX? Use your own real-life analogy (not the farmer's market or supermarket one from the notes)
2. In your own words, explain why the **spread** is important and what a large spread tells you about a market
3. Why do DEXs need **liquidity pools** instead of orderbooks?
4. Explain the **x * y = k** formula with a brand new example (not ETH/USDT — pick any two tokens)
5. What is **slippage** and why does it matter when making a large trade?
6. What is the difference between a **DEX** and a **DEX aggregator**? Give one real-world example of each (Uniswap, Jupiter, 1inch, etc.)
7. If you set slippage tolerance to 0.1% on a volatile day — what will likely happen to your trade? Why?

---

### Task 2 — CPMM Math Practice

Given a liquidity pool with **500 SOL** and **50,000 USDC**:

1. What is `k` (the constant product)?
2. What is the current price of 1 SOL in USDC?
3. Someone buys **50 SOL** from the pool. How much USDC do they have to pay?
4. What is the new price of 1 SOL after the trade?
5. What was the **price impact** of this trade (in %)?

---

### Task 3 — Build a CPMM Price Calculator

Build a simple React component (or Node.js script) that simulates an AMM liquidity pool:

**Inputs:**
- Token A reserve (e.g., 100 ETH)
- Token B reserve (e.g., 10,000 USDT)
- Amount of Token A to buy

**Outputs:**
- k (constant product)
- Current price (B/A)
- Amount of Token B required
- New price after trade
- Price impact (%)
- Slippage (difference from expected price)

```js
function calculateSwap(reserveA, reserveB, amountAOut) {
  const k = reserveA * reserveB;
  const priceBeforeSwap = reserveB / reserveA;

  const newReserveA = reserveA - amountAOut;
  const newReserveB = k / newReserveA;
  const amountBIn = newReserveB - reserveB;
  const priceAfterSwap = newReserveB / newReserveA;
  const priceImpact = ((priceAfterSwap - priceBeforeSwap) / priceBeforeSwap) * 100;

  return {
    k,
    priceBeforeSwap,
    amountBIn,
    newReserveA,
    newReserveB,
    priceAfterSwap,
    priceImpact: priceImpact.toFixed(4) + "%"
  };
}
```

---

## Bonus Challenges

### Challenge 1 — Orderbook Simulator

Build a simple orderbook simulation in JavaScript/React:
- Maintain a list of bids (sorted highest to lowest) and asks (sorted lowest to highest)
- Add new orders
- Match orders when bid ≥ ask
- Calculate and display the current spread

### Challenge 2 — Live DEX Data

Use the **Jupiter API** (Solana's DEX aggregator) to:
1. Fetch a quote for swapping 1 SOL → USDC
2. Display: input amount, output amount, price impact, slippage
3. Optionally execute the swap using wallet adapter

```js
// Jupiter Quote API
const response = await fetch(
  `https://quote-api.jup.ag/v6/quote?inputMint=So11111111111111111111111111111111111111112&outputMint=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v&amount=1000000000&slippageBps=50`
);
const quote = await response.json();
console.log(quote);
```

### Challenge 3 — Impermanent Loss Calculator

Read about impermanent loss (ref below), then build a calculator:
- Inputs: initial price ratio, new price ratio, liquidity provided
- Output: impermanent loss % vs simply holding

**Ref**: https://www.gemini.com/cryptopedia/decentralized-finance-impermanent-loss-defi

---

## References

- DEX Slides: https://petal-estimate-4e9.notion.site/Decentralized-exchanges-1147dfd1073580dd8956cd90985c3fd7
- Jupiter API: https://docs.jup.ag/docs/apis/swap-api
- Uniswap Docs: https://docs.uniswap.org/
- Impermanent Loss: https://www.gemini.com/cryptopedia/decentralized-finance-impermanent-loss-defi
- DLMMs & CLMMs: https://medium.com/@innocentnweke/why-and-how-to-use-dlmm-dynamic-liquidity-market-maker-9c97a41321b6
