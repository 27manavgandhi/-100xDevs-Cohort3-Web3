# 9.1 - DEX, CEX, Orderbooks, AMM & DeFi Jargon

> **Course**: 100xDevs Cohort 3.0 — Web3 Track
> **Instructor**: Harkirat Singh
> **Week**: 9.1
> **Class Slides**: https://petal-estimate-4e9.notion.site/Decentralized-exchanges-1147dfd1073580dd8956cd90985c3fd7
> **Notes**: https://feather-lion-ff2.notion.site/Week-9-1-116246afc9f2801ea8adc07e1c1a2a22

---

## Topics Covered Today

1. Decentralized Exchanges (DEX) — farmer's market analogy
2. Centralized Exchanges (CEX) — supermarket analogy
3. DEX vs CEX — side by side comparison
4. CEX Jargon — Orderbooks, Bids, Asks, Spread, Liquidity, Market Makers
5. How does a DEX work? — 6 key mechanics
6. How Pricing Works in DEXs — the x * y = k formula (CPMM)
7. DEX Jargon — Markets, Swap, Quote, Slippage, Slippage Tolerance
8. DEX vs. DEX Aggregator
9. More reads — Impermanent Loss, DLMMs, CLMMs

---

## 1. Decentralized Exchanges (DEX)

"Dex" stands for **Decentralized Exchange**, which is a place where people can trade (buy or sell) cryptocurrencies directly with each other **without using a middleman**, like a bank or a traditional exchange.

### Real-Life Example

Imagine a **farmer's market**. Each farmer comes with their fruits, veggies, or other goods. Instead of going to a supermarket (where the supermarket is the middleman), buyers at the market can go directly to each farmer's stand, check out their products, and trade right there. You pay the farmer directly in cash or trade them another item they might need.

A **Dex** works similarly. Instead of a big company like Coinbase or Binance (the "supermarket"), people trade cryptocurrencies directly with each other, peer-to-peer, like at a farmer's market.

### How It Works in Blockchain

1. **No Middleman**: Like in the farmer's market, there's no central entity managing the trades. You just use a platform (the market space) to find people willing to trade with you
2. **Smart Contracts**: These are like automated stalls at the farmer's market. You walk up to a stall, drop in your goods (cryptocurrency), and the smart contract ensures the trade happens safely and fairly with whoever wants to buy it
3. **Direct Ownership**: Just like you physically own your fruits at the farmer's market, on a Dex, you own your cryptocurrency until the moment you decide to trade it. There's no central party holding it for you

> In simple terms, a **DEX** is a cryptocurrency trading platform that operates without a central authority, allowing users to trade assets directly with one another (peer-to-peer) using smart contracts.

---

## 2. CEX (Centralized Exchange)

"Cex" stands for **Centralized Exchange**, which is an online platform where you can buy, sell, or trade cryptocurrencies, but this platform is **run by a company that acts as a middleman** to facilitate the trades.

### Real-Life Example

Think of a **supermarket**. In a supermarket, all the products are controlled by the store. You don't deal directly with the farmers or producers; the supermarket is the middleman who stocks all the goods, sets the prices, and makes sure everything is available for you. You go to the store, pick what you want, pay the cashier, and leave.

A **Cex** works similarly to a supermarket. You don't directly deal with other people who want to trade cryptocurrency; instead, the exchange (like Coinbase or Binance) handles all the trading for you.

### How It Works in Blockchain

1. **Middleman**: The Cex (exchange) acts like the supermarket. It holds all the cryptocurrencies and manages the buying and selling for you. You deposit your money into their account, and they handle the trades
2. **Order Matching**: When you want to buy or sell cryptocurrency, the Cex automatically matches your order with another user's order — like how a supermarket restocks or sells items to customers
3. **Custody**: When you trade through a Cex, you don't actually hold your cryptocurrency directly. It's more like putting money in your supermarket's gift card — the exchange holds your crypto for you until you want to withdraw it

> A Cex is like a supermarket for cryptocurrencies where the company (the exchange) controls all the trading, matching, and storage of the assets.

---

## 3. DEX vs CEX

| | DEX | CEX |
|---|---|---|
| 1 | You have the **private key** of your wallet | You **delegate your assets** to a central entity |
| 2 | No one can censor you / take your assets (not true for centralized tokens like USDC) | You don't have to do private key management |
| 3 | You have to do **private key management** yourself | Govt can censor you, you have to **KYC** |
| | | Exchange can get **hacked** |

**DEX examples**: Meteora, Raydium, ORCA
**CEX examples**: Binance, CoinDCX, Coinbase

> **Recommended Video about CEX**: https://youtu.be/aEMBp98qfwc?si=qXmS_lpA26L1Qfdi

---

## 4. CEX Jargon

### 1. Orderbooks

An **orderbook** is like a **menu board at a restaurant** that lists all the buy and sell orders for a cryptocurrency in one place. It shows the prices people are willing to pay to buy (bids) and the prices at which others are willing to sell (asks).

**Example**: If you want to buy a pizza, the orderbook would show who is willing to sell you a pizza and at what price, as well as others who want to buy pizzas and what they're willing to pay. It's a real-time list of offers from buyers and sellers.

### 2. Bids

**Bids** are the **offers made by buyers** to purchase a cryptocurrency at a specific price.

**Example**: Imagine you want to buy a pizza for $10. Your "bid" is $10 for one pizza. If someone is willing to sell at that price, you get the pizza.

In the CEX, bids are the prices that buyers are willing to pay for a particular cryptocurrency, listed in the orderbook.

### 3. Asks

**Asks** (or "offers") are the **offers made by sellers** who want to sell their cryptocurrency at a specific price.

**Example**: If you're selling a pizza for $12, your "ask" is $12. If someone wants to buy a pizza at that price, they accept your ask.

In the CEX, asks are the prices that sellers are willing to accept for their cryptocurrency, and they also appear in the orderbook.

### 4. Spread

The **spread** is the **difference between the highest bid price and the lowest ask price** in the orderbook. It essentially shows the gap between what buyers are willing to pay and what sellers are willing to accept.

**Example**: If the highest bid for a pizza is $10 (buyer wants to pay $10), and the lowest ask is $12 (seller wants $12), then the spread is **$2**. The smaller the spread, the closer buyers and sellers are to agreeing on a price.

- **Small spread** = more active market
- **Large spread** = less activity or fewer traders willing to agree on a price

### 5. Liquidity

**Liquidity** refers to **how easily and quickly you can buy or sell a cryptocurrency without affecting its price**.

**Example**: If you go to a huge pizza party where there are tons of pizzas being sold and bought all the time, that's a "liquid" market — you can buy or sell pizza at almost any moment without changing the price much. But if there's only one pizza seller and one buyer, it's harder to make a quick trade without adjusting the price.

- **High liquidity** = quickly buy/sell large amounts without much price change
- **Low liquidity** = trades might be slower and lead to bigger price swings

### 6. Market Makers

**Market makers** are traders or entities that **add liquidity** to the market by placing both buy (bid) and sell (ask) orders on the exchange. They help keep the market active and the spreads tight.

**Example**: Think of market makers as **pizza vendors at a party** who always have pizzas ready to buy or sell. They ensure that if you want a pizza, you can always get one, and if you want to sell one, there's someone willing to buy it. This makes it easy to trade at any time without big price jumps.

In CEX, market makers profit from the spread (the difference between their bid and ask prices) and help keep the market flowing smoothly.

### Summary — CEX Jargon Quick Recap

- **Orderbooks**: A list of all buy and sell orders
- **Bids**: Prices buyers are willing to pay
- **Asks**: Prices sellers want to receive
- **Spread**: The price gap between the highest bid and lowest ask
- **Liquidity**: How easily you can trade without changing the price much
- **Market Makers**: Entities that provide liquidity by always being ready to buy or sell

---

## 5. How Does a DEX Work?

### 1. Peer-to-Peer Trading
On a DEX, traders interact directly with each other to buy or sell assets. There is **no middleman or central authority** holding your funds or managing the trades. Instead, trades happen directly between users' wallets.

**Example**: Imagine two people trading baseball cards. One person wants to trade a rare card for a different one. They meet directly, swap cards, and the trade is complete. There's no need for a card shop or manager to oversee the transaction.

### 2. Smart Contracts Automate Trades
A DEX uses **smart contracts** — self-executing programs on the blockchain. These contracts automatically execute the terms of a trade (like swapping one cryptocurrency for another) once the conditions are met.

**Example**: Think of a vending machine. You insert money, select your item, and the machine automatically dispenses it. A smart contract is like the vending machine for crypto trading — once the required funds are inserted (cryptocurrency), it automatically performs the trade without needing a human operator.

### 3. Token Swaps Through Liquidity Pools
Many DEXs use a model called **Automated Market Making (AMM)**, which relies on **liquidity pools**. A liquidity pool is a collection of funds locked in a smart contract, and these funds are used to enable trading between different cryptocurrency pairs (like swapping ETH for USDT).

**Example**: Think of a **community pool of money**. People contribute money to a pot that anyone in the community can use to exchange bills of different denominations (like swapping $10 bills for $1 bills). Contributors to this pool are called **liquidity providers**, and they earn a small fee whenever someone uses the pool to swap currencies.

### 4. Pricing with Algorithms
Since there's no centralized orderbook (like on a CEX), DEXs use **algorithms to set prices**. The most common algorithm is based on the **Constant Product Formula (x * y = k)**, which adjusts prices based on the ratio of tokens in the liquidity pool.

**Example**: If a pool has 100 apples and 200 oranges, the algorithm will adjust the exchange rate (price) of apples to oranges based on the ratio. If you buy a lot of apples, the ratio changes, and apples become more expensive compared to oranges.

### 5. No Custody Over Your Funds
On a DEX, you **retain full control** over your cryptocurrency throughout the trade. You use a **crypto wallet** (like MetaMask) to connect directly to the DEX and approve transactions.

**Example**: It's like bringing your own backpack to the farmer's market. You keep your goods (cryptos) in your backpack until you decide to make a trade. You never have to leave your goods with a central storage (like a bank).

### 6. Transparency and Security
Because trades are executed on the blockchain and controlled by smart contracts, **everything is transparent and verifiable**. You can see the trade history, liquidity pool balances, and smart contract codes. Plus, since there is no central point of failure (no company holding your funds), it's often more secure from hacks targeting centralized entities.

### Common Examples of DEXs
- **Uniswap**: A popular Ethereum-based DEX that uses the AMM model with liquidity pools
- **SushiSwap**: A fork of Uniswap with additional features
- **PancakeSwap**: A DEX built on the Binance Smart Chain with similar functionality to Uniswap

---

## 6. How Pricing Works in DEXs — x * y = k

In DEXs, there is no centralized orderbook to match buyers and sellers. Instead, **algorithms** determine the price of assets based on **liquidity pools**. The most common algorithm is the **Constant Product Market Maker (CPMM)** model.

### The Formula: x * y = k

- **x** and **y** represent the quantities of two different tokens in a liquidity pool (e.g., ETH and USDT)
- **k** is a **constant product**, meaning it always stays the same
- This formula says: **the product of the two token quantities (x and y) must remain constant**. When someone makes a trade, the balance changes, which changes the price

### Example — ETH / USDT Pool

```
Initial pool: 100 ETH and 10,000 USDT
k = x * y = 100 × 10,000 = 1,000,000

Someone wants to buy 10 ETH from the pool:
→ Pool now has 90 ETH (they took out 10)
→ New y = k / x = 1,000,000 / 90 = 11,111.11 USDT
→ Trader must add: 11,111.11 - 10,000 = 1,111.11 USDT to the pool

Before trade: 1 ETH = 100 USDT (10,000 / 100)
After trade:  1 ETH = 123.46 USDT (11,111.11 / 90)

Price increased! The more ETH someone buys, the higher the price becomes.
```

### How the Algorithm Determines Price

- The price of one token in terms of another is determined by the **ratio of the two token quantities in the pool**
- As someone buys ETH → ETH in pool decreases → USDT increases → ETH becomes more expensive
- As someone sells ETH → ETH in pool increases → USDT decreases → ETH becomes cheaper

> This mechanism creates a **dynamic price adjustment** that balances the supply and demand within the pool without needing a centralized orderbook or intermediary.

### Slippage and Price Impact

- The **larger the trade relative to the size of the pool**, the more the price will change during the trade — this change is called **slippage**
- If the pool is **large** (has a lot of liquidity), the price impact of any single trade is smaller
- If the pool is **small**, even a modest trade can cause a significant change in price
- This is why **larger pools provide better price stability**

---

## 7. DEX Jargon

### 1. Markets
In the context of a DEX, **markets** are specific pairs of cryptocurrencies that you can trade with each other. Each market is a trading pair, showing which two assets you can swap.

**Example**: If you want to trade ETH for USDT, then **ETH/USDT** is the market you're trading in. Each market operates independently, and prices vary depending on the supply and demand of the tokens in that market's liquidity pool.

### 2. Swap
A **swap** is the action of exchanging one cryptocurrency for another on a DEX. It is essentially a trade but done in a decentralized way without a middleman. The DEX uses liquidity pools and an automated market maker (AMM) algorithm to calculate the price and complete the trade.

**Example**: You have 10 DAI (a stablecoin), and you want to get ETH. When you "swap" on a DEX, you send your 10 DAI to the liquidity pool, and the pool sends you the equivalent value of ETH based on the current price.

### 3. Quote
A **quote** is the **estimated amount of the token you'll receive** when you perform a swap. It's like a price estimate given by the DEX before you confirm your trade. This quote takes into account the current market price, the liquidity pool balance, and any fees involved.

**Example**: If you want to swap 100 USDT for ETH, the DEX will provide a quote showing how much ETH you will get for your 100 USDT. The quote is usually based on the current price in the liquidity pool but can change slightly by the time the transaction is completed.

### 4. Slippage
**Slippage** is the **difference between the price you expect to pay (or receive) when you initiate a swap and the actual price you end up paying (or receiving) when the swap is completed**. Slippage happens because the price can change during the time it takes for the transaction to be processed, especially if the market is volatile or if the trade size is large compared to the liquidity in the pool.

**Example**: If you want to swap 10 ETH for USDT and the quote says you'll receive **10,000 USDT**, but by the time your trade goes through, you only receive **9,800 USDT** — that 200 USDT difference is called slippage.

### 5. Slippage Tolerance
**Slippage tolerance** is a setting you can adjust when making a swap. It's the **maximum amount of slippage you're willing to accept** for the trade to go through. If the price moves beyond this tolerance during the swap, the transaction will fail. This protects you from unexpected price changes.

**Example**: If you set your slippage tolerance at **1%**, it means you're okay with a price movement of up to 1% during the swap. If the price changes more than 1%, your swap won't go through.

**Why It's Important**: 
- **High slippage tolerance** → trade goes through but you might pay more or receive less than expected
- **Low slippage tolerance** → might make your trade fail, especially in volatile markets

### Summary — DEX Jargon Quick Recap

- **Markets**: Trading pairs on the DEX (e.g., ETH/USDT)
- **Swap**: Exchanging one cryptocurrency for another
- **Quote**: The estimated amount you'll get when you make a swap
- **Slippage**: The difference between the expected price of a trade and the actual price
- **Slippage Tolerance**: The maximum price movement you're willing to accept for a swap — if exceeded, the trade won't go through

---

## 8. DEX vs. DEX Aggregator

Both **DEXs** and **DEX aggregators** facilitate cryptocurrency trading in a decentralized manner, but they have different functions.

| Aspect | DEX (Decentralized Exchange) | DEX Aggregator |
|---|---|---|
| Liquidity Source | Single liquidity pool per platform | Pulls liquidity from multiple DEXs |
| Trade Optimization | Trades directly within one platform | Finds the best prices across several DEXs, splits trade if needed |
| Price Efficiency | Prices vary depending on the DEX's liquidity | Offers better prices by aggregating liquidity |
| Slippage Control | Prone to higher slippage in low-liquidity pools | Reduces slippage by spreading trades across multiple pools |
| User Effort | Manually choose which DEX to trade on | Automatically optimizes trades for the user |

### Summary

- **DEX**: A platform where you can directly trade cryptocurrencies using the liquidity available on that specific exchange
- **DEX Aggregator**: A tool that scans multiple DEXs to find the best prices and liquidity for your trade, automatically optimizing the process to minimize costs and slippage

> In short, a **DEX** is like a single store where you buy your goods, while a **DEX aggregator** is like a shopping assistant that checks all the nearby stores to find the best deal for you!

---

## 9. More Reads

- **Impermanent Loss**: https://www.gemini.com/cryptopedia/decentralized-finance-impermanent-loss-defi
- **DLMMs, CLMMs**: https://medium.com/@innocentnweke/why-and-how-to-use-dlmm-dynamic-liquidity-market-maker-9c97a41321b6

---

## Summary

A **DEX (Decentralized Exchange)** enables peer-to-peer cryptocurrency trading without a middleman, similar to a farmer's market where users swap assets directly using smart contracts and liquidity pools. Prices are determined by algorithms like the **x * y = k** formula, allowing dynamic adjustments based on supply and demand. In contrast, a **CEX (Centralized Exchange)** operates like a supermarket where a company controls all trading, custody, and pricing through an orderbook system with bids, asks, and market makers providing liquidity. While a CEX offers centralized control and ease of trading, a DEX provides user ownership of funds, transparency, and automated trading. Key jargon includes **swaps** (trading assets on a DEX), **quotes** (price estimates), and **slippage** (price changes during trade execution). A **DEX aggregator** further optimizes trades by searching multiple DEXs for the best price and liquidity.

---

## Key Concepts Table

| Concept | Description |
|---|---|
| DEX | Peer-to-peer crypto exchange with no middleman — farmer's market |
| CEX | Company-run exchange with custody and orderbooks — supermarket |
| Orderbook | List of all buy (bids) and sell (asks) orders at various prices |
| Bid | Buyer's offer price — what they're willing to pay |
| Ask | Seller's offer price — what they want to receive |
| Spread | Gap between highest bid and lowest ask — smaller = more liquid |
| Liquidity | How easily you can trade without moving the price |
| Market Maker | Entity that places both bids + asks to keep markets liquid |
| AMM | Automated Market Maker — algorithm-based pricing using liquidity pools |
| CPMM | Constant Product Market Maker — uses x * y = k formula |
| Liquidity Pool | Smart contract holding two tokens to enable trading |
| Liquidity Provider | User who deposits tokens into a pool and earns fees |
| x * y = k | The pricing formula — product of token quantities stays constant |
| Slippage | Difference between expected and actual price received in a swap |
| Slippage Tolerance | Max % price change you'll accept before trade auto-cancels |
| Quote | Estimated output you'll receive before confirming a swap |
| Swap | Exchanging one token for another on a DEX |
| Market (DEX) | A trading pair (e.g., ETH/USDT) with its own liquidity pool |
| DEX Aggregator | Scans multiple DEXs to find best price + split trades — shopping assistant |
| Impermanent Loss | Loss liquidity providers face when pool ratio changes vs holding |

---

## References

- Class Slides: https://petal-estimate-4e9.notion.site/Decentralized-exchanges-1147dfd1073580dd8956cd90985c3fd7
- Week 9.1 Notes: https://feather-lion-ff2.notion.site/Week-9-1-116246afc9f2801ea8adc07e1c1a2a22
- CEX Deep Dive Video: https://youtu.be/aEMBp98qfwc?si=qXmS_lpA26L1Qfdi
- Impermanent Loss: https://www.gemini.com/cryptopedia/decentralized-finance-impermanent-loss-defi
- DLMMs & CLMMs: https://medium.com/@innocentnweke/why-and-how-to-use-dlmm-dynamic-liquidity-market-maker-9c97a41321b6
