# 5.1 - Wallet Adapter & dApp Development

> **Course**: 100xDevs Cohort 3.0 — Web3 Track
> **Instructor**: Harkirat Singh
> **Week**: 5.1
> **Slides**: https://petal-estimate-4e9.notion.site/Wallet-adapter-860feade9cb940cea696eedf4fc61251
> **Notes**: https://feather-lion-ff2.notion.site/Week-5-1-797e1e0b818a43138146e362a4a3cc77
> **Project Repo**: https://github.com/27manavgandhi/Solana-Web3-Wallet-Interaction-App

---

## Recap Until Now

1. **Week 1** — Bitcoin Whitepaper, Decentralized currencies
2. **Week 2** — Encryption, Decryption, Hashing, ed25519, Public and Private keys
3. **Week 3** — Creating a Web Based Wallet (OptiMask)
4. **Week 4** — Solana Jargon, Accounts, Tokens, Token Program

---

## Topics Covered Today

1. Building a web-based wallet recap
2. Building a **dApp** — what it is and how it differs from a wallet
3. Pre-requisites (React, useState)
4. **DAPP** — Decentralized Application concept
5. **Solana Wallet Adapter** — the universal wallet connector
6. React + useState recap
7. Things a wallet does (airdrop, balance, send tx, sign message)
8. Requesting airdrop / Creating a faucet
9. Assignment + Challenges

---

## 1. Building a Web Based Wallet vs a dApp

### What we've built so far
We've built a `wallet` — but no one would use a `new` wallet. People already have wallets (Phantom, Backpack, Solflare). They use new **dApps**.

### What is a dApp?
A **dApp** (decentralized application) is like an app on your phone, but it works on a blockchain network instead of being controlled by a single company.

When you use a wallet like MetaMask or Trust Wallet, you can access dApps directly from there.

Examples of dApps:
- A game (earn tokens by playing)
- A marketplace (trade NFTs)
- A finance tool (swap tokens, earn yield)

Since it's decentralized, **no one person or company controls it** — the blockchain ensures everything runs according to rules set in the code. Your wallet connects you to these dApps, allowing you to interact with them securely using your crypto funds.

---

## 2. Solana Wallet Adapter

The **Solana Wallet Adapter** is like a **universal charger** for Solana wallets.

> Imagine you have different gadgets (phone, tablet, laptop) that all need charging, but each has a different charging cable. Instead of a different cable for each gadget, you have **one charger that works with all of them**.

In the same way, when building a dApp on Solana, users might have different wallets (Phantom, Backpack, Solflare, Glow...). The Solana Wallet Adapter is that universal charger — making sure any user can easily connect to your dApp without a different setup for each one.

**In simple terms**: The Solana Wallet Adapter is a set of tools and guidelines that makes it easier for developers to integrate various Solana wallets into their web applications.

### Key packages

```bash
npm install @solana/wallet-adapter-base \
    @solana/wallet-adapter-react \
    @solana/wallet-adapter-react-ui \
    @solana/wallet-adapter-wallets \
    @solana/web3.js
```

### Key hooks provided

| Hook | What it does |
|---|---|
| `useWallet()` | Access connected wallet, publicKey, signTransaction |
| `useConnection()` | Access the Solana RPC connection |
| `WalletMultiButton` | Pre-built connect/disconnect button UI |
| `WalletModalProvider` | Modal for wallet selection |

---

## 3. React Recap

### What is React?
React is a JavaScript library used to build user interfaces, especially for web apps. It lets you create **reusable components** — like building blocks — to make it easier and faster to develop interactive and dynamic websites. React updates the web page quickly when data changes, making the experience smoother for users.

### useState()

`useState()` is like having a special box where you can store something and change it whenever you want.

```jsx
const [count, setCount] = useState(0);

// Every time you click, count increases
<button onClick={() => setCount(count + 1)}>Clicked {count} times</button>
```

**Real life analogy**: Imagine a toy car. You want to track how many times you play with it. You start at 0. Every time you play, you take out the number, add 1, put it back. `useState()` is that box.

### Creating a React App

```bash
npm create vite@latest
# Write Project Name
# Select "React"
# Select "Javascript"
```

Then go to `src/App.jsx` and clean it up:

```jsx
import './App.css'

function App() {
  return (
    <div>
      hi there
    </div>
  )
}

export default App
```

Add dependencies:

```bash
npm install @solana/wallet-adapter-base \
    @solana/wallet-adapter-react \
    @solana/wallet-adapter-react-ui \
    @solana/wallet-adapter-wallets \
    @solana/web3.js
```

Clean up CSS files — delete content of `index.css` and `App.css`.

---

## 4. Things a Wallet Does

Once a user connects to your dApp, you usually ask them to do a few things with their wallet:

1. **Request Airdrop** — get free devnet SOL for testing
2. **Show SOL balance** — GET data from the blockchain
3. **Send a transaction** — send SOL or tokens to another address
4. **Sign a message** — verify ownership of the wallet without spending SOL

---

## 5. Requesting Airdrop (Creating a Faucet)

Inspired by: https://solfaucet.com/

### How it works

- `@solana/web3.js` provides a `requestAirdrop` function
- You can get the current user's public key using the `useWallet` hook

### Airdrop Component

```jsx
// src/Airdrop.jsx
import { useConnection, useWallet } from "@solana/wallet-adapter-react";

export function Airdrop() {
  const wallet = useWallet();
  const { connection } = useConnection();

  async function sendAirdropToUser() {
    const amount = document.querySelector("input").value;
    await connection.requestAirdrop(wallet.publicKey, amount * 1000000000);
    alert("Airdrop sol");
  }

  return (
    <div>
      <input type="text" placeholder="Amount" />
      <button onClick={sendAirdropToUser}>Send Airdrop</button>
    </div>
  );
}
```

### App.jsx — Full Setup with Wallet Adapter

```jsx
import React, { FC, useMemo } from "react";
import {
  ConnectionProvider,
  WalletProvider,
} from "@solana/wallet-adapter-react";
import {
  WalletModalProvider,
  WalletDisconnectButton,
  WalletMultiButton,
} from "@solana/wallet-adapter-react-ui";
import { Airdrop } from "./Airdrop";
import "@solana/wallet-adapter-react-ui/styles.css";

function App() {
  return (
    <ConnectionProvider endpoint={"https://solana-devnet.g.alchemy.com/v2/YOUR_API_KEY"}>
      <WalletProvider wallets={[]} autoConnect>
        <WalletModalProvider>
          <WalletMultiButton />
          <WalletDisconnectButton />
          <Airdrop />
          {/* Your app's components go here, nested within the context providers. */}
        </WalletModalProvider>
      </WalletProvider>
    </ConnectionProvider>
  );
}

export default App;
```

### How the providers work

```
ConnectionProvider  ← sets which RPC endpoint to use (Alchemy/Quicknode/devnet)
  └── WalletProvider  ← manages wallet connection state
        └── WalletModalProvider  ← provides the connect wallet modal UI
              └── Your App Components
                    ├── WalletMultiButton  ← connect button
                    ├── WalletDisconnectButton  ← disconnect button
                    └── Airdrop / ShowBalance / SendTransaction etc.
```

---

## 6. Show SOL Balance

```jsx
// src/ShowSolBalance.jsx
import { useConnection, useWallet } from "@solana/wallet-adapter-react";
import { useState } from "react";
import { LAMPORTS_PER_SOL } from "@solana/web3.js";

export function ShowSolBalance() {
  const { connection } = useConnection();
  const wallet = useWallet();
  const [balance, setBalance] = useState(null);

  async function getBalance() {
    const bal = await connection.getBalance(wallet.publicKey);
    setBalance(bal / LAMPORTS_PER_SOL);
  }

  return (
    <div>
      <button onClick={getBalance}>Get Balance</button>
      {balance !== null && <p>Balance: {balance} SOL</p>}
    </div>
  );
}
```

---

## 7. Send Transaction

```jsx
// src/SendTransaction.jsx
import { useConnection, useWallet } from "@solana/wallet-adapter-react";
import { PublicKey, SystemProgram, Transaction, LAMPORTS_PER_SOL } from "@solana/web3.js";

export function SendTransaction() {
  const { connection } = useConnection();
  const wallet = useWallet();

  async function sendTransaction() {
    const to = document.getElementById("to").value;
    const amount = document.getElementById("amount").value;

    const transaction = new Transaction().add(
      SystemProgram.transfer({
        fromPubkey: wallet.publicKey,
        toPubkey: new PublicKey(to),
        lamports: amount * LAMPORTS_PER_SOL,
      })
    );

    const { blockhash } = await connection.getLatestBlockhash();
    transaction.recentBlockhash = blockhash;
    transaction.feePayer = wallet.publicKey;

    const sig = await wallet.sendTransaction(transaction, connection);
    alert("Transaction sent: " + sig);
  }

  return (
    <div>
      <input id="to" type="text" placeholder="To address" />
      <input id="amount" type="text" placeholder="Amount (SOL)" />
      <button onClick={sendTransaction}>Send SOL</button>
    </div>
  );
}
```

---

## 8. Sign a Message

```jsx
// src/SignMessage.jsx
import { useWallet } from "@solana/wallet-adapter-react";
import { ed25519 } from "@noble/curves/ed25519";
import { useCallback } from "react";

export function SignMessage() {
  const { publicKey, signMessage } = useWallet();

  const sign = useCallback(async () => {
    const message = document.getElementById("message").value;
    const encodedMessage = new TextEncoder().encode(message);
    const signature = await signMessage(encodedMessage);

    if (!ed25519.verify(signature, encodedMessage, publicKey.toBytes())) {
      throw new Error("Message signature invalid!");
    }
    alert("Message signed and verified successfully!");
  }, [publicKey, signMessage]);

  return (
    <div>
      <input id="message" type="text" placeholder="Message to sign" />
      <button onClick={sign}>Sign Message</button>
    </div>
  );
}
```

---

## 9. Assignment

1. **Show user token balances** — list all SPL tokens the connected wallet holds
2. **Let user transfer tokens** — build a transfer UI for SPL tokens

### Challenges / Things to Learn

1. Extract metadata and show the user the **ticker** and **logo** of each token
2. Use the `@solana/spl-token` library — make it work purely from the frontend

### Very Hard Assignment

Add payments to: https://github.com/code100x/muzer

---

## Summary

In summary, we've learned how things are happening internally, how to use a **dApp** by implementing how to create a web based wallet. Today's class is all about practically implementing web-based wallet interactions via dApps using the Solana Wallet Adapter.

---

## Key Concepts

| Concept | Description |
|---|---|
| dApp | Decentralized app running on blockchain, accessed via wallet |
| Wallet Adapter | Universal connector library for Solana wallets |
| ConnectionProvider | Provides RPC endpoint to all child components |
| WalletProvider | Manages wallet connection state |
| WalletModalProvider | Renders the connect wallet modal |
| useWallet() | Hook to access connected wallet + publicKey |
| useConnection() | Hook to access the RPC connection |
| WalletMultiButton | Pre-built connect/select wallet button |
| requestAirdrop() | Devnet-only function to get free SOL |
| sendTransaction() | Signs + sends a transaction via connected wallet |
| signMessage() | Signs arbitrary data without sending a transaction |

---

## References

- Slides: https://petal-estimate-4e9.notion.site/Wallet-adapter-860feade9cb940cea696eedf4fc61251
- Week 5.1 Notes: https://feather-lion-ff2.notion.site/Week-5-1-797e1e0b818a43138146e362a4a3cc77
- Project Repo: https://github.com/27manavgandhi/Solana-Web3-Wallet-Interaction-App
- Wallet Adapter Docs: https://github.com/solana-labs/wallet-adapter
- solfaucet reference: https://solfaucet.com/
- Week 5 Code: https://github.com/100xdevs-cohort-3/week-5-web3
