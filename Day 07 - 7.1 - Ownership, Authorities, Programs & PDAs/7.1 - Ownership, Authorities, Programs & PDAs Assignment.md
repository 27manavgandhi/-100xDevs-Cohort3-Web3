# 7.1 - Ownership, Authorities, Programs & PDAs — Assignment

> **Slides**: https://petal-estimate-4e9.notion.site/Ownership-Authorities-Programs-and-PDAs-b2b8bfeae8064753982be9bd67afbb7b
> **Notes**: https://feather-lion-ff2.notion.site/Week-7-1-92fcd8f45fd44550bc0c65a232ea4cfd

---

## Core Assignment

### Task 1 — Explore Accounts on Solana Explorer

Visit the following accounts on Solana Explorer and answer for each:
- Is it a wallet, data, or program account?
- What is the `owner`?
- Is `executable` true or false?
- How many lamports does it hold?

Accounts to explore:
1. `EPJFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v` (USDC mint)
2. `TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA` (Token Program)
3. Your own devnet wallet address

---

### Task 2 — Create, Mint, Revoke Authority (CLI)

Practice the full mint authority lifecycle:

```bash
# Step 1: Create a token
spl-token create-token

# Step 2: Create your ATA
spl-token create-account <token_mint_address>

# Step 3: Mint 1 billion tokens
spl-token mint <token_mint_address> 1000000000

# Step 4: Verify mint authority on Solscan/Explorer
# → Check the "Mint Authority" field shows your wallet

# Step 5: Revoke mint authority
spl-token authorize <token_id> mint --disable

# Step 6: Try to mint again — should fail!
spl-token mint <token_mint_address> 1000000000

# Step 7: Verify on Solscan — mint authority should now show "None"
```

Answer: Why would a token project want to revoke mint authority?

---

### Task 3 — Derive ATAs using PDAs (Code)

Write a Node.js script that:
1. Takes any wallet address and any token mint address
2. Derives the ATA address using `findProgramAddressSync`
3. Checks if the ATA account exists on-chain using `connection.getAccountInfo()`
4. If it exists, fetches and displays the token balance

```bash
npm install @solana/web3.js @solana/spl-token
```

```js
import { Connection, PublicKey, clusterApiUrl } from "@solana/web3.js";
import {
  ASSOCIATED_TOKEN_PROGRAM_ID,
  TOKEN_PROGRAM_ID,
  getAssociatedTokenAddressSync,
  getAccount
} from "@solana/spl-token";

const connection = new Connection(clusterApiUrl("devnet"), "confirmed");

async function getATAInfo(walletAddress, mintAddress) {
  const wallet = new PublicKey(walletAddress);
  const mint = new PublicKey(mintAddress);

  // Derive ATA (this is a PDA!)
  const ata = getAssociatedTokenAddressSync(mint, wallet, false, TOKEN_PROGRAM_ID);
  console.log("ATA (PDA):", ata.toBase58());

  // Check if it exists
  const accountInfo = await connection.getAccountInfo(ata);
  if (!accountInfo) {
    console.log("ATA does not exist yet");
    return;
  }

  // Fetch balance
  const tokenAccount = await getAccount(connection, ata);
  console.log("Balance:", tokenAccount.amount.toString());
}

getATAInfo(
  "YOUR_WALLET_ADDRESS",
  "YOUR_TOKEN_MINT_ADDRESS"
);
```

---

### Task 4 — Conceptual Questions

Answer in your own words:

1. Why can't a PDA have a private key?
2. What is the difference between `createProgramAddressSync` and `findProgramAddressSync`?
3. Why does the bump seed exist?
4. If you revoke mint authority and later want to mint more tokens — can you? Why or why not?
5. What is the difference between the **owner** of an account and the **authority** of a program?
6. Why is the BPF Loader the owner of all custom programs?

---

## Bonus Challenges

### Challenge 1 — Build an Account Explorer UI

Build a React component that:
1. Takes any Solana address as input
2. Fetches `connection.getAccountInfo(address)`
3. Displays: owner, lamports (in SOL), executable, data size
4. Shows whether it's a wallet, data account, or program account

### Challenge 2 — Revoke Mint Authority from Code

Instead of using the CLI, write a JS script that revokes mint authority programmatically:

```js
import { setAuthority, AuthorityType } from "@solana/spl-token";

await setAuthority(
  connection,
  payer,
  mintAddress,
  payer.publicKey,      // current authority
  AuthorityType.MintTokens,
  null                  // null = permanently revoke
);
console.log("Mint authority revoked — supply is now fixed forever");
```

### Challenge 3 — Derive Multiple PDAs

For a given program ID and different seed combinations, derive 5 different PDAs and verify none of them have corresponding private keys (all fall off ed25519 curve).

---

## References

- Solana Accounts: https://solana.com/docs/core/accounts
- PDAs: https://solana.com/docs/core/pda
- PDA Video: https://www.youtube.com/watch?v=p0eD29d8JCM
- Token Authority: https://spl.solana.com/token#authority-delegation
